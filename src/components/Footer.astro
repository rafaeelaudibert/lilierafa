---
import { WEDDING_CONFIG, type Locale } from "../constants/wedding"
import { getLocale } from "astro-i18n-aut"

const locale = getLocale(Astro.url) as Locale
const config = WEDDING_CONFIG[locale]
---

<footer class="bg-gray-800 text-white pt-16 pb-8">
  <div class="max-w-6xl mx-auto px-4">
    <div class="grid md:grid-cols-2 gap-12 items-center">
      <!-- Left side - Navigation and info -->
      <div>
        <div class="mb-8">
          <h3 class="text-2xl font-bold mb-4">{config.couple.them}</h3>
          <p class="text-gray-300 mb-6">
            {config.wedding.date} â€¢ {config.wedding.time}
          </p>
        </div>

        <!-- Navigation links -->
        <div class="flex flex-wrap gap-6 mb-6">
          {
            config.navigation.map((link) => (
              <a
                href={link.href}
                class="text-gray-300 hover:text-white transition-colors duration-200"
              >
                {link.label}
              </a>
            ))
          }
        </div>

        <!-- Contact info -->
        <div class="flex flex-col gap-1 text-sm text-gray-400">
          <a
            href={`mailto:${config.contact.email}`}
            class="hover:text-white transition-colors duration-200"
          >
            {config.contact.email}</a
          >
          <a
            href={`tel:${config.contact.phone.replace(/\s/g, "")}`}
            class="hover:text-white transition-colors duration-200"
          >
            {config.contact.phone}
          </a>
        </div>
      </div>

      <!-- Right side - Countdown -->
      <div class="flex flex-col items-end">
        <h4 class="text-lg font-semibold mb-4">
          {config.footer.countdown.label}
        </h4>
        <div id="countdown" class="flex flex-row gap-4">
          <div class="bg-gray-700 rounded-lg p-4">
            <div id="days" class="text-2xl font-bold text-[var(--brown)]">
              --
            </div>
            <div class="text-xs text-gray-300 mt-1">
              {config.footer.countdown.days}
            </div>
          </div>
          <div class="bg-gray-700 rounded-lg p-4">
            <div id="hours" class="text-2xl font-bold text-[var(--brown)]">
              --
            </div>
            <div class="text-xs text-gray-300 mt-1">
              {config.footer.countdown.hours}
            </div>
          </div>
          <div class="bg-gray-700 rounded-lg p-4">
            <div id="minutes" class="text-2xl font-bold text-[var(--brown)]">
              --
            </div>
            <div class="text-xs text-gray-300 mt-1">
              {config.footer.countdown.minutes}
            </div>
          </div>
          <div class="bg-gray-700 rounded-lg p-4">
            <div id="seconds" class="text-2xl font-bold text-[var(--brown)]">
              --
            </div>
            <div class="text-xs text-gray-300 mt-1">
              {config.footer.countdown.seconds}
            </div>
          </div>
        </div>
      </div>
    </div>

    <div
      class="border-t border-gray-700 mt-12 pt-8 text-center text-sm text-gray-400"
    >
      <p>{config.footer.content}</p>
    </div>
  </div>
</footer>

<script is:inline define:vars={{ config }}>
  function updateCountdown() {
    const now = new Date().getTime()
    const weddingDate = new Date(config.wedding.fullDate).getTime()
    const distance = weddingDate - now

    if (distance < 0) {
      // Wedding has passed
      document.getElementById("days").textContent = "00"
      document.getElementById("hours").textContent = "00"
      document.getElementById("minutes").textContent = "00"
      document.getElementById("seconds").textContent = "00"
      return
    }

    const days = Math.floor(distance / (1000 * 60 * 60 * 24))
    const hours = Math.floor(
      (distance % (1000 * 60 * 60 * 24)) / (1000 * 60 * 60)
    )
    const minutes = Math.floor((distance % (1000 * 60 * 60)) / (1000 * 60))
    const seconds = Math.floor((distance % (1000 * 60)) / 1000)

    document.getElementById("days").textContent = days
      .toString()
      .padStart(2, "0")
    document.getElementById("hours").textContent = hours
      .toString()
      .padStart(2, "0")
    document.getElementById("minutes").textContent = minutes
      .toString()
      .padStart(2, "0")
    document.getElementById("seconds").textContent = seconds
      .toString()
      .padStart(2, "0")
  }

  // Update countdown immediately and then every second
  updateCountdown()
  setInterval(updateCountdown, 1000)
</script>
